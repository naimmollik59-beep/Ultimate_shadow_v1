<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SHADOW_V155</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { --blood: #ff0000; --shadow-blue: #0088ff; --gold: #ffd700; --dead-black: #000000; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body { 
            background: var(--dead-black); 
            color: #fff; 
            font-family: 'Space Mono', monospace; 
            height: 100dvh; 
            margin: 0; 
            overflow: hidden; 
            display: flex; 
            flex-direction: column; 
            padding-bottom: env(safe-area-inset-bottom);
        }

        .combat-header { padding: 15px 20px; border-bottom: 2px solid #222; background: #000; position: relative; height: 320px; flex-shrink: 0; }
        .header-title { font-size: 14px; font-family: 'Archivo Black'; letter-spacing: 2px; text-transform: uppercase; }
        .signal-line { height: 1px; background: linear-gradient(90deg, transparent, var(--blood), transparent); position: relative; overflow: hidden; width: 100px; margin-top: 4px; z-index: 20; }
        .signal-line::after { content: ""; position: absolute; width: 50%; height: 100%; background: white; animation: sweep 2s infinite; }
        @keyframes sweep { from { left: -100%; } to { left: 100%; } }

        .stat-group { position: absolute; top: 65px; right: 15px; width: 110px; z-index: 30; display: flex; flex-direction: column; gap: 6px; }
        .mini-bar { height: 4px; width: 100%; background: #111; border-radius: 2px; overflow: hidden; border: 1px solid #222; }
        .fill-xp { height: 100%; background: var(--gold); transition: width 0.3s; box-shadow: 0 0 5px var(--gold); }
        .fill-sp { height: 100%; background: var(--shadow-blue); transition: width 0.3s; box-shadow: 0 0 5px var(--shadow-blue); }
        .fill-hyd { height: 100%; background: #00f2ff; transition: width 0.3s; box-shadow: 0 0 5px #00f2ff; }
        .stat-label { font-size: 7px; font-weight: bold; text-transform: uppercase; margin-bottom: 1px; display: flex; justify-content: space-between; opacity: 0.8; }

        #shadow-3d-container { position: absolute; top: 50px; left: 0; width: 100%; height: 180px; z-index: 1; pointer-events: none; }

        .chrono-block { position: absolute; bottom: 35px; left: 20px; right: 20px; height: 45px; background: #050505; border: 1px solid #222; z-index: 15; display: flex; align-items: center; justify-content: space-between; padding: 0 10px; gap: 10px; }
        .timer-display { font-family: 'Archivo Black'; font-size: 18px; color: var(--blood); letter-spacing: 1px; width: 85px; text-align: center; border-right: 1px solid #222; height: 100%; display: flex; align-items: center; }
        .timer-inputs { flex-grow: 1; display: flex; align-items: center; gap: 8px; }
        #t-input { width: 45px; height: 28px; background: #000; border: 1px solid #333; color: #fff; font-size: 10px; text-align: center; }
        .ignite-btn { flex-grow: 1; height: 28px; background: #000; border: 1px solid var(--blood); color: var(--blood); font-family: 'Archivo Black'; font-size: 9px; text-transform: uppercase; cursor: pointer; }

        .hp-segment-container { display: flex; gap: 3px; position: absolute; bottom: 10px; left: 20px; right: 20px; z-index: 10; }
        .hp-segment { height: 5px; flex-grow: 1; background: #111; transition: background 0.3s; }
        .hp-active { background: var(--blood); box-shadow: 0 0 8px var(--blood); }

        main { flex-grow: 1; overflow-y: auto; padding: 15px 20px; scrollbar-width: none; background: rgba(0,0,0,0.95); z-index: 5; position: relative; }
        .module { background: #0a0a0a; border: 1px solid #222; padding: 12px; margin-bottom: 12px; }
        .tag { font-family: 'Archivo Black'; font-size: 8px; color: var(--blood); text-transform: uppercase; margin-bottom: 5px; display: block; }
        
        #log-area { font-size: 9px; color: #555; height: 160px; overflow-y: auto; display: flex; flex-direction: column-reverse; gap: 4px; border-left: 1px solid #222; padding-left: 10px; }
        .log-entry { border-bottom: 1px solid #111; padding-bottom: 2px; }
        .log-ts { color: var(--blood); margin-right: 5px; opacity: 0.7; }

        .btn-strike { background: var(--blood); color: #000; font-family: 'Archivo Black'; padding: 14px; width: 100%; font-size: 11px; cursor: pointer; text-transform: uppercase; border: none; }
        
        nav { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            height: 70px; 
            background: #000; 
            border-top: 1px solid #222; 
            z-index: 20; 
            flex-shrink: 0;
            padding-bottom: env(safe-area-inset-bottom);
        }
        .nav-link { display: flex; justify-content: center; align-items: center; color: #333; transition: 0.2s; }
        .nav-link.active { color: var(--blood); }

        .shop-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #111; font-size: 10px; }
        .shop-cost { color: var(--shadow-blue) !important; font-weight: bold; }
        .shop-buy-btn { border: 1px solid var(--blood); color: var(--blood); padding: 4px 8px; font-size: 8px; text-transform: uppercase; font-family: 'Archivo Black'; }

        .note-entry { font-size: 10px; background: #050505; padding: 10px; border-left: 2px solid var(--blood); margin-bottom: 8px; display: flex; justify-content: space-between; align-items: flex-start; }
        .note-del { color: #333; font-size: 10px; cursor: pointer; transition: 0.2s; }
        
        .note-controls { display: grid; grid-template-columns: 1fr 1fr 4fr; gap: 5px; margin-top: 8px; }
        .ctrl-btn { background: #111; border: 1px solid #222; color: #444; height: 35px; display: flex; align-items: center; justify-content: center; font-size: 12px; cursor: pointer; }
        .ctrl-btn.active { color: var(--blood); border-color: var(--blood); }
        .archive-main-btn { background: #000; border: 1px solid #0044ff; color: #0044ff; font-family: 'Archivo Black'; font-size: 9px; text-transform: uppercase; }

        /* CLEAR DATA SECTION */
        .danger-zone { margin-top: 20px; border-top: 2px solid #300; padding-top: 15px; margin-bottom: 30px;}
        .btn-purge { background: #1a0000; border: 1px solid #ff0000; color: #ff0000; font-family: 'Archivo Black'; padding: 15px; width: 100%; font-size: 10px; cursor: pointer; text-transform: uppercase; box-shadow: 0 0 10px rgba(255,0,0,0.2); }
    </style>
</head>
<body onload="bootShadow()">

    <header class="combat-header">
        <div class="flex justify-between items-start relative z-20">
            <div>
                <h1 class="header-title">Shadow_Alpha</h1>
                <div class="signal-line"></div>
                <p class="text-[8px] font-bold opacity-40 uppercase mt-2">Level_<span id="lvl-val">1</span></p>
            </div>
            <div class="text-right text-[9px] font-bold">
                <div id="clock" class="opacity-50">00:00:00</div>
                <div id="bat" class="text-red-600">PWR: --%</div>
                <div id="charge-status" class="text-[7px] font-bold uppercase">
                    <span id="st-ico"><i class="fa-solid fa-battery-half"></i></span> <span id="st-text">DISCHARGING</span>
                </div>
            </div>
        </div>

        <div class="stat-group">
            <div><span class="stat-label">XP <span id="xp-txt">0/500</span></span><div class="mini-bar"><div id="bar-xp" class="fill-xp" style="width:0%"></div></div></div>
            <div><span class="stat-label">SP <span id="sp-txt">0/100</span></span><div class="mini-bar"><div id="bar-sp" class="fill-sp" style="width:0%"></div></div></div>
            <div><span class="stat-label">HYD <span id="hyd-txt">0/4000 ML</span></span><div class="mini-bar"><div id="bar-hyd" class="fill-hyd" style="width:0%"></div></div></div>
        </div>

        <div id="shadow-3d-container"></div>

        <div class="chrono-block">
            <div class="timer-display" id="t-disp">00:00</div>
            <div class="timer-inputs">
                <input type="number" id="t-input" placeholder="MINS" min="1">
                <button class="ignite-btn" onclick="igniteTimer()" id="ignite-btn">IGNITE</button>
                <i class="fa-solid fa-rotate-right text-[10px] opacity-30" onclick="resetTimer()"></i>
            </div>
        </div>

        <div class="hp-segment-container" id="hp-grid"></div>
    </header>

    <main id="viewport">
        <section id="p-neural" class="pane">
            <div class="module"><span class="tag">System_Logs</span><div id="log-area"></div></div>
            <button onclick="triggerPing()" class="btn-strike">Ping Secondary Node</button>
        </section>

        <section id="p-vitals" class="pane hidden">
            <div class="module text-center"><span class="tag">Hydration Intake</span><div class="text-3xl font-black mb-4"><span id="w-v">0</span>ML</div>
                <div class="grid grid-cols-2 gap-2"><button onclick="logW(250)" class="bg-zinc-900 py-3 text-[10px] font-bold">+250ML</button><button onclick="logW(500)" class="bg-zinc-900 py-3 text-[10px] font-bold">+500ML</button></div>
            </div>
            <div class="module"><span class="tag">Nutrient Intake</span>
                <input type="text" id="meal-input" class="w-full bg-black border border-zinc-800 p-2 text-[10px] text-white outline-none mb-2" placeholder="Describe intake...">
                <button onclick="logMeal()" class="text-[8px] font-bold text-red-600 border border-red-900 px-2 py-1 uppercase w-full">Commit (+50 XP)</button>
            </div>
        </section>

        <section id="p-quests" class="pane hidden">
            <div class="module"><span class="tag">Missions</span>
                <input type="text" id="task-input" class="w-full bg-black border border-zinc-800 p-2 text-[10px] text-white outline-none mb-2" placeholder="Target objective...">
                <button onclick="addTask()" class="text-[8px] font-bold text-red-600 border border-red-900 px-2 py-1 uppercase w-full">Deploy</button>
            </div>
            <div id="q-list" class="space-y-2 mt-4"></div>
        </section>

        <section id="p-chrono" class="pane hidden">
            <div class="module"><span class="tag">Node_Life</span><div class="text-xl font-bold uppercase">UPTIME MONITOR</div><div class="text-[10px] opacity-30 mt-2 font-bold">ACTIVE: <span id="uptime">0S</span></div></div>
            <div class="module border-red-900">
                <span class="tag text-red-500"><i class="fa-solid fa-cart-shopping"></i> Black_Market</span>
                <div id="shop-list" class="mt-2 divide-y divide-zinc-900">
                    <div class="shop-item"><div><span>Music (30m)</span><br><span class="opacity-30 text-[8px]">Low Toxicity</span></div><div class="flex items-center gap-3"><span class="shop-cost">5 SP</span><button onclick="buyItem('Music', 5)" class="shop-buy-btn">Buy</button></div></div>
                    <div class="shop-item"><div><span>YouTube (20m)</span><br><span class="opacity-30 text-[8px]">Med Toxicity</span></div><div class="flex items-center gap-3"><span class="shop-cost">15 SP</span><button onclick="buyItem('YouTube', 15)" class="shop-buy-btn">Buy</button></div></div>
                    <div class="shop-item"><div><span>Reels (10m)</span><br><span class="opacity-30 text-[8px]">High Toxicity</span></div><div class="flex items-center gap-3"><span class="shop-cost">30 SP</span><button onclick="buyItem('Reels', 30)" class="shop-buy-btn">Buy</button></div></div>
                    <div class="shop-item"><div><span>XP Injection</span><br><span class="opacity-30 text-[8px]">Artificial Growth</span></div><div class="flex items-center gap-3"><span class="shop-cost">50 SP</span><button onclick="buyXP(100, 50)" class="shop-buy-btn">Buy</button></div></div>
                </div>
            </div>
        </section>

        <section id="p-char" class="pane hidden">
            <div class="module"><span class="tag">Identity Core</span>
                <div class="space-y-2 text-[11px]">
                    <div class="flex justify-between"><span>NAME</span><span class="font-bold">SUNNY</span></div>
                    <div class="flex justify-between"><span>ALIAS</span><span class="font-bold text-red-600">SUNLESS</span></div>
                    <div class="flex justify-between"><span>COMPANION</span><a href="https://trigger.macrodroid.com/b375a918-afa6-40c5-aeff-619b6b4a7373/shadow_try" target="_blank" class="text-red-600 underline font-bold uppercase">TAKWA</a></div>
                </div>
            </div>
            <div class="module"><span class="tag">Neural_Archive</span>
                <textarea id="note-input" class="w-full h-24 bg-black border border-zinc-900 p-2 text-xs text-white outline-none mb-1" placeholder="Record entry..."></textarea>
                <div class="note-controls">
                    <button id="mic-btn" onclick="startVoice()" class="ctrl-btn"><i class="fa-solid fa-microphone"></i></button>
                    <button onclick="document.getElementById('media-input').click()" class="ctrl-btn"><i class="fa-solid fa-paperclip"></i></button>
                    <button onclick="archiveNote()" class="archive-main-btn">Archive Data</button>
                </div>
                <input type="file" id="media-input" class="hidden" onchange="handleFile(this)">
                <div id="note-history" class="mt-4"></div>
            </div>
            <div class="danger-zone">
                <button onclick="nuclearReset()" class="btn-purge">WIPE SYSTEM DATA (AUTH REQ)</button>
            </div>
        </section>
    </main>

    <nav>
        <button onclick="tabSwitch('neural', this)" class="nav-link active"><i class="fa-solid fa-ghost"></i></button>
        <button onclick="tabSwitch('vitals', this)" class="nav-link"><i class="fa-solid fa-droplet"></i></button>
        <button onclick="tabSwitch('quests', this)" class="nav-link"><i class="fa-solid fa-crosshairs"></i></button>
        <button onclick="tabSwitch('chrono', this)" class="nav-link"><i class="fa-solid fa-bolt"></i></button>
        <button onclick="tabSwitch('char', this)" class="nav-link"><i class="fa-solid fa-skull"></i></button>
    </nav>

    <script>
        let state = { lvl: 1, xp: 0, sp: 0, water: 0, hp: 100, tasks: [], logs: [], noteArchive: [] };
        let timer = { seconds: 0, active: false, interval: null };
        const XP_LIMIT = 500, HYD_LIMIT = 4000, SP_CONV = 20, AUTH_KEY = "1420";
        let startTime = Date.now(), head;

        function nuclearReset() {
            const pass = prompt("CONFIRM PURGE CODE:");
            if (pass === AUTH_KEY) {
                localStorage.removeItem("SHADOW_DATA_FINAL");
                location.reload();
            } else {
                pushLog("ERR: INVALID AUTH KEY");
            }
        }

        function startVoice() {
            const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRec) { pushLog("VOICE NOT SUPPORTED"); return; }
            const rec = new SpeechRec();
            rec.onstart = () => document.getElementById('mic-btn').classList.add('active');
            rec.onresult = (e) => document.getElementById('note-input').value += e.results[0][0].transcript;
            rec.onend = () => document.getElementById('mic-btn').classList.remove('active');
            rec.start();
        }

        function handleFile(input) {
            if (input.files && input.files[0]) {
                const name = input.files[0].name;
                document.getElementById('note-input').value += ` [FILE: ${name}]`;
                pushLog(`FILE LINKED: ${name}`);
            }
        }

        function archiveNote() {
            const input = document.getElementById('note-input');
            if(!input.value.trim()) return;
            state.noteArchive.unshift({ id: Date.now(), text: input.value.trim(), date: new Date().toLocaleString() });
            input.value = ""; renderArchive(); pushLog("NEURAL ENTRY ARCHIVED"); saveData();
        }

        function deleteNote(id) { state.noteArchive = state.noteArchive.filter(n => n.id !== id); renderArchive(); saveData(); }

        function renderArchive() {
            const box = document.getElementById('note-history');
            if(!box) return;
            box.innerHTML = (state.noteArchive || []).map(n => `<div class="note-entry"><div class="note-content"><span class="note-date" style="font-size:7px; opacity:0.4; display:block;">${n.date}</span>${n.text}</div><i class="fa-solid fa-trash-can note-del" onclick="deleteNote(${n.id})"></i></div>`).join('');
        }

        function speak(text) {
            if (!window.speechSynthesis) return;
            try {
                if (window.speechSynthesis.speaking) window.speechSynthesis.cancel();
                const utter = new SpeechSynthesisUtterance(text.replace(/ML/g, "milliliters"));
                utter.pitch = 0.6; utter.rate = 1.1; window.speechSynthesis.speak(utter);
            } catch (e) { }
        }

        function igniteTimer() {
            const btn = document.getElementById('ignite-btn');
            const input = document.getElementById('t-input');
            if (timer.active) { clearInterval(timer.interval); timer.active = false; btn.innerText = "RESUME"; pushLog("TIMER SUSPENDED"); return; }
            if (timer.seconds <= 0) {
                const mins = parseInt(input.value) || 0;
                if (mins <= 0) return;
                timer.seconds = mins * 60;
                input.value = "";
                pushLog(`TIMER INITIALIZED: ${mins} MINUTE WINDOW`); 
            } else { pushLog("TIMER RESUMED"); }
            timer.active = true; btn.innerText = "PAUSE";
            timer.interval = setInterval(() => {
                timer.seconds--;
                if (timer.seconds <= 0) { clearInterval(timer.interval); timer.active = false; btn.innerText = "IGNITE"; pushLog("CHRONO ELAPSED"); speak("Time elapsed."); }
                updateTimerUI();
            }, 1000);
        }

        function updateTimerUI() {
            const m = Math.floor(timer.seconds / 60), s = timer.seconds % 60;
            document.getElementById('t-disp').innerText = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        }

        function resetTimer() { clearInterval(timer.interval); timer.seconds = 0; timer.active = false; document.getElementById('t-disp').innerText = "00:00"; document.getElementById('ignite-btn').innerText = "IGNITE"; }

        function init3D() {
            const container = document.getElementById('shadow-3d-container');
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(40, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            scene.add(new THREE.AmbientLight(0x404040, 2));
            const pointLight = new THREE.PointLight(0xff0000, 2.5);
            pointLight.position.set(2, 2, 5);
            scene.add(pointLight);
            new THREE.GLTFLoader().load('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/models/gltf/LeePerrySmith/LeePerrySmith.glb', (gltf) => {
                head = gltf.scene; head.scale.set(0.42, 0.42, 0.42); head.position.y = -0.15;
                head.traverse((c) => { if (c.isMesh) c.material = new THREE.MeshPhongMaterial({ color: 0x050000, emissive: 0xff0000, emissiveIntensity: 0.2, wireframe: true }); });
                scene.add(head);
            });
            camera.position.z = 4.5;
            function animate() { requestAnimationFrame(animate); if (head) head.rotation.y += 0.003; renderer.render(scene, camera); }
            animate();
        }

        function tabSwitch(p, btn) {
            document.querySelectorAll('.pane').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            document.getElementById('p-' + p).classList.remove('hidden');
            btn.classList.add('active');
        }

        function buyItem(name, cost) { if(state.sp >= cost) { state.sp -= cost; pushLog(`AUTHORIZED: ${name.toUpperCase()}.`); updateUI(); } else { pushLog(`FAILURE: INSUFFICIENT SP.`); } }
        function buyXP(amt, cost) { if(state.sp >= cost) { state.sp -= cost; state.xp += amt; updateUI(); pushLog(`XP INJECTION SUCCESS.`); } else { pushLog(`FAILURE: INSUFFICIENT SP.`); } }
        
        function pushLog(msg) { 
            const ts = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' }); 
            state.logs.push({ts: ts, text: msg}); 
            if(state.logs.length > 20) state.logs.shift(); 
            renderLogs(); 
            speak(msg); 
            saveData(); 
        }

        function renderLogs() { const area = document.getElementById('log-area'); if(area) area.innerHTML = state.logs.map(l => `<div class="log-entry"><span class="log-ts">[${l.ts}]</span> ${l.text}</div>`).join(''); }
        function gainXP(amt) { state.xp += amt; state.sp += (amt / SP_CONV); if(state.xp >= XP_LIMIT) { state.lvl++; state.xp -= XP_LIMIT; pushLog(`LEVEL UP.`); } updateUI(); }
        function logW(ml) { state.water = Math.min(HYD_LIMIT, state.water + ml); pushLog(`HYDRATED: ${ml}ML`); gainXP(10); }
        function logMeal() { const val = document.getElementById('meal-input').value; if(!val) return; pushLog(`MEAL: ${val.toUpperCase()}`); gainXP(50); document.getElementById('meal-input').value = ""; }
        
        function addTask() { 
            const val = document.getElementById('task-input').value; 
            if(!val) return; 
            state.tasks.push({text: val, done: false}); 
            pushLog(`MISSION DEPLOYED: ${val.toUpperCase()}`); 
            document.getElementById('task-input').value = ""; 
            renderTasks(); 
            updateUI(); 
        }

        function renderTasks() { const list = document.getElementById('q-list'); if(list) list.innerHTML = state.tasks.map((t, i) => `<div class="module flex justify-between items-center py-2"><span class="text-[10px] ${t.done?'line-through opacity-30':''}">${t.text.toUpperCase()}</span><button onclick="completeTask(${i})" class="text-red-600 text-[10px]"><i class="fa-solid ${t.done?'fa-redo':'fa-check'}"></i></button></div>`).join(''); }
        function completeTask(i) { state.tasks[i].done = !state.tasks[i].done; if(state.tasks[i].done) { gainXP(25); pushLog("OBJECTIVE SECURED"); } renderTasks(); }
        function triggerPing() { fetch('https://trigger.macrodroid.com/b375a918-afa6-40c5-aeff-619b6b4a7373/confused'); pushLog("PING SENT"); gainXP(5); }
        function saveData() { localStorage.setItem("SHADOW_DATA_FINAL", JSON.stringify(state)); }

        function bootShadow() {
            const saved = localStorage.getItem("SHADOW_DATA_FINAL");
            if(saved) { state = JSON.parse(saved); renderLogs(); renderTasks(); renderArchive(); }
            init3D(); updateUI();
            setInterval(() => { 
                if(document.getElementById('clock')) document.getElementById('clock').innerText = new Date().toLocaleTimeString(); 
                if(document.getElementById('uptime')) document.getElementById('uptime').innerText = Math.floor((Date.now() - startTime)/1000) + "S";
            }, 1000);
            navigator.getBattery().then(b => { 
                const u = () => { 
                    if(document.getElementById('bat')) document.getElementById('bat').innerText = `PWR: ${Math.floor(b.level * 100)}%`;
                    const statusBox = document.getElementById('charge-status');
                    if(b.charging) { statusBox.style.color = "#eab308"; document.getElementById('st-text').innerText = "CHARGING"; }
                    else { statusBox.style.color = "#71717a"; document.getElementById('st-text').innerText = "DISCHARGING"; }
                }; 
                u(); b.onlevelchange = u; b.onchargingchange = u;
            });
            if(state.logs.length === 0) pushLog("SHADOW ONLINE");
        }

        function updateUI() {
            document.getElementById('lvl-val').innerText = state.lvl;
            document.getElementById('bar-xp').style.width = ((state.xp/XP_LIMIT)*100) + "%";
            document.getElementById('xp-txt').innerText = `${Math.floor(state.xp)}/${XP_LIMIT}`;
            document.getElementById('bar-sp').style.width = (state.sp > 100 ? 100 : state.sp) + "%";
            document.getElementById('sp-txt').innerText = `${state.sp.toFixed(1)}/100`;
            document.getElementById('bar-hyd').style.width = ((state.water/HYD_LIMIT)*100) + "%";
            document.getElementById('hyd-txt').innerText = `${state.water}/${HYD_LIMIT} ML`;
            document.getElementById('w-v').innerText = state.water;
            const grid = document.getElementById('hp-grid');
            if(grid) { grid.innerHTML = ''; for(let i=0; i<10; i++) { const seg = document.createElement('div'); seg.className = `hp-segment ${i < (state.hp/10) ? 'hp-active' : ''}`; grid.appendChild(seg); } }
            saveData();
        }
    </script>
</body>
</html>
